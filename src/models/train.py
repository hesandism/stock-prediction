# code for the training loop